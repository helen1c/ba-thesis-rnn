from RnnLayer import RnnLayer
import numpy as np

rnn = RnnLayer(3, 2, 3, 5, use_bias=False)
rnn.input_weights = np.array([[-0.1553,  0.4239,  0.3296],
        [ 0.3714, -0.5253, -0.3836]])
rnn.hidden_weights = np.array([[ 0.0805,  0.1363],
        [-0.3552,  0.5272]])

x = np.array([[[-0.3569, -1.5037, -1.8602],
         [-0.2346, -0.0264, -0.2283],
         [-0.6484,  0.5830,  0.5309]],

        [[-1.9576, -1.8198, -1.3264],
         [-0.0254,  2.0516,  0.8738],
         [-0.3639, -0.6940,  0.7836]],

        [[-0.4094, -0.4804,  1.1435],
         [-0.4696, -0.1970,  1.3389],
         [ 0.6671,  0.1869, -0.6012]],

        [[ 1.3367,  0.0405,  2.3852],
         [ 1.8146,  0.8041, -0.1837],
         [ 0.3763, -0.3636, -1.1467]],

        [[ 0.4333,  1.3355,  0.6118],
         [ 0.2881, -1.0250,  0.0670],
         [-0.5394,  0.9531,  0.8956]]])

h0 = np.array([[[-1.1960e-03, -2.1143e-01],
         [-6.9080e-01,  1.8693e+00],
         [-1.0647e+00,  8.0038e-01],
         [ 1.0773e+00,  1.5206e+00],
         [ 9.7399e-01,  5.9333e-01]]])

output, hn = rnn.forward(x)
print(output)