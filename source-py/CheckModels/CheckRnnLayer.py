from RnnLayer import RnnLayer
import numpy as np

rnn = RnnLayer(3, 2, 3, 5, use_bias=False)
rnn.input_weights = np.array([[ 0.6788, -0.1185, -0.3209],
        [-0.1504, -0.5302, -0.5914]])
rnn.hidden_weights = np.array([[-0.3293, -0.7057],
        [ 0.4569, -0.3218]])

x = np.array([[[ 1.1519, -0.6252,  0.6032],
         [ 0.2217, -0.6599,  0.7558],
         [ 0.3837, -0.8975, -0.6245]],

        [[-1.0752, -2.7231,  1.2755],
         [-2.1347,  0.9780,  1.7502],
         [ 0.3319,  0.9980, -0.7191]],

        [[-0.3921, -0.1970, -0.1227],
         [-0.0735,  1.3885, -1.1722],
         [-0.4768,  0.3924,  1.3277]],

        [[ 0.1474, -0.0536,  0.6477],
         [-0.4474,  0.3695, -1.0442],
         [ 0.0474,  0.6425,  0.5955]],

        [[ 0.6867,  0.1203,  1.3233],
         [ 1.1980,  0.6102, -2.8583],
         [-2.4124, -0.7813, -0.6187]]])

output, _ = rnn.forward(x)
print(output.shape)
print(output)
print(np.transpose(output, (1,0,2)))